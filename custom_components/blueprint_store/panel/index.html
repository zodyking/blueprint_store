<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Blueprint Store</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Shoelace (autoloader) -->
    <script type="module" src="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.15.0/cdn/shoelace-autoloader.js"></script>

    <style>
      :root{
        --blue-1:#0a5bd8; --blue-2:#0d3b8e; --ink:#e6f0ff; --muted:#b9c7e6;
        --card-bg: linear-gradient(180deg, rgba(10,20,52,.78), rgba(8,18,46,.80));
        --card-bd: rgba(170,200,255,.22);
        --card-bd-hover:#9dd1ff66;
        --shadow: 0 18px 50px rgba(6,16,50,.45);
        --maxw: 1200px;

        --sl-input-background-color: transparent;
        --sl-input-border-color: rgba(255,255,255,.32);
        --sl-color-neutral-0: rgba(16,34,86,.98);
        --sl-panel-background-color: rgba(16,34,86,.98);
      }

      * { box-sizing: border-box; }
      body{
        margin:0; color:var(--ink);
        font-family: ui-sans-serif, system-ui, Segoe UI, Roboto, Ubuntu, "Helvetica Neue", Arial;
        background: linear-gradient(180deg, var(--blue-1), var(--blue-2));
        min-height:100vh;
      }
      body::after{
        content:""; position:fixed; inset:0; z-index:-1; pointer-events:none;
        background-image:
          linear-gradient(to right, rgba(255,255,255,.12) 1px, transparent 1px),
          linear-gradient(to bottom, rgba(255,255,255,.12) 1px, transparent 1px);
        background-size: 28px 28px;
      }

      header{ position:sticky; top:0; z-index:8; backdrop-filter:blur(8px); border-bottom:1px solid #ffffff22; }
      .bar{
        max-width:var(--maxw); margin:0 auto; padding:8px 12px;
        display:grid; grid-template-columns:auto 1fr auto auto auto; gap:10px; align-items:center;
      }
      .brand{ display:flex; gap:10px; align-items:center; font-weight:900; }
      .brand img{ width:28px; height:28px; border-radius:6px; }

      sl-input::part(base){ background:transparent; }
      sl-input::part(input){ color:#fff; }
      sl-input::part(form-control-label){ color:#fff; }

      sl-button.plain::part(base){
        background:transparent; color:#fff; border:none; box-shadow:none; padding-inline:10px;
      }
      sl-button.plain::part(base):hover{ text-decoration: underline; }

      main{ max-width:var(--maxw); margin:12px auto 44px; padding:0 12px; }

      .banner{ margin:8px 0 12px; border-radius:16px; overflow:hidden; box-shadow:var(--shadow); border:1px solid #ffffff22; }
      .banner img{ width:100%; display:block; }

      .cards-wrap{ position:relative; }
      .cards-wrap::before{
        content:""; position:absolute; inset:-34px -18px -34px -18px; z-index:-1;
        background: radial-gradient(60% 55% at 50% 8%, rgba(155,205,255,.18), transparent 60%),
                    radial-gradient(60% 60% at 50% 100%, rgba(40,140,255,.18), transparent 65%);
        filter: blur(18px);
      }

      .section-title{ margin:8px 0 8px; font-size:20px; font-weight:900; letter-spacing:.2px; }

      /* Creators Spotlight */
      .contrib{ margin: 18px 0; padding: 16px; border-radius: 18px; border:1px solid var(--card-bd); background: var(--card-bg); box-shadow: var(--shadow); }
      .contrib-head{ display:flex; align-items:baseline; gap:12px; margin-bottom:12px; }
      .contrib-head h3{ margin:0; font-size:20px; font-weight:900; }
      .contrib-sub{ color:var(--muted); }
      .contrib-grid{ display:grid; grid-template-columns: repeat(3,minmax(0,1fr)); gap:12px; }
      @media (max-width: 980px){ .contrib-grid{ grid-template-columns: 1fr; } }
      .contrib-card{ border:1px solid var(--card-bd); background: linear-gradient(180deg, rgba(10,20,52,.82), rgba(8,18,46,.84)); border-radius:14px; padding:16px; display:flex; flex-direction:column; justify-content:center; align-items:center; min-height:120px; text-align:center; }
      .contrib-card h4{ margin:0 0 6px 0; font-weight:900; font-size:16px; }
      .contrib-author{ opacity:.9; font-weight:800; margin-bottom:8px; }

      /* Cards */
      .card{
        border-radius:18px; border:1px solid var(--card-bd); background:var(--card-bg);
        box-shadow: var(--shadow); padding:16px; margin:12px 0; overflow:hidden;
      }
      .card:hover{ border-color:var(--card-bd-hover); box-shadow: 0 26px 60px rgba(30,140,255,.30); }
      .row{ display:flex; gap:12px; align-items:baseline; flex-wrap:wrap; }
      .card h3{ margin:0; font-size:18px; font-weight:900; }
      .author{ opacity:.92; font-weight:700; }
      .tags{ display:flex; gap:6px; flex-wrap:wrap; margin:6px 0 10px; }
      .tag{ background:#0e2a66; border:1px solid #29539a; color:#cfe2ff; padding:2px 8px; border-radius:999px; font-size:12px; }
      .uses{ background:#ffffff22; border:1px solid #ffffff33; border-radius:999px; padding:3px 8px; font-weight:700; }

      /* SINGLE description area that expands/collapses */
      .desc-wrap{
        position:relative; background:rgba(6, 16, 46, .65);
        border:1px solid rgba(255,255,255,.12); border-radius:12px;
        padding:12px; margin:8px 0;
        max-height: 140px; overflow:hidden;
      }
      .desc-wrap::after{
        content:""; position:absolute; left:0; right:0; bottom:0; height:60px;
        background: linear-gradient(to top, rgba(6,16,46,.85), rgba(6,16,46,0));
        pointer-events:none;
      }
      .desc-wrap.expanded{ max-height:none; }
      .desc-wrap.expanded::after{ display:none; }
      .desc-wrap :where(h1,h2,h3){ font-weight:800; }
      .desc-wrap img{ max-width:100%; height:auto; border-radius:8px; }
      .desc-wrap a{ color:#aee1ff; }
      .desc-wrap pre{ white-space:pre-wrap; background:#07122f; padding:8px; border-radius:8px; overflow:auto; }

      .toggle{ color:#cfe2ff; font-weight:700; cursor:pointer; user-select:none; }
      .card__footer{ display:flex; justify-content:space-between; align-items:center; margin-top:12px; }

      /* CTA pills */
      .myha-btn{
        --grad-a:#00b2ff; --grad-b:#0a84ff;
        display:inline-flex; align-items:center; gap:8px;
        padding:10px 14px; border-radius:999px; font-weight:800;
        color:#032149; text-decoration:none;
        background: linear-gradient(135deg, var(--grad-a), var(--grad-b));
        box-shadow: 0 10px 24px rgba(4,96,200,.35), inset 0 1px 0 #fff6;
        border: 1px solid rgba(255,255,255,.35);
      }
      .myha-btn.secondary{ --grad-a:#1b2a6b; --grad-b:#2c57b8; color:#eaf4ff; }
      .myha-btn.gray{
        --grad-a:#5b667a; --grad-b:#495267; color:#f6f8ff;
      }

      /* like/stat pill */
      .stat-pill{
        display:inline-flex; align-items:center; gap:8px;
        padding:10px 14px; border-radius:999px; font-weight:800;
        border:1px solid rgba(255,255,255,.35);
        background: rgba(10,20,52,.45);
      }
      .stat-pill .icon-heart{ width:18px; height:18px; display:inline-block;
        mask: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='white'%3E%3Cpath d='M12 21s-6.716-4.478-9.192-8.308C.93 10.17 1.54 7.6 3.514 6.2 5.487 4.799 8.1 5.093 9.6 6.8L12 9.5l2.4-2.7c1.5-1.707 4.113-2.001 6.086-.6 1.974 1.4 2.584 3.97.706 6.492C18.716 16.522 12 21 12 21z'/%3E%3C/svg%3E") center/contain no-repeat;
        background:#fff; }
      .stat-pill .liked-text{ opacity:.9; }

      #error, #empty{ text-align:center; color:#e7eefc; }
      #sentinel{ height:60px; }

      /* simple loader for Spotlight */
      .loader{ display:inline-block; width:18px; height:18px; border-radius:50%; border:3px solid #8fb9ff; border-top-color:transparent; animation:spin 0.9s linear infinite; vertical-align:middle;}
      @keyframes spin{ to { transform:rotate(360deg); } }
    </style>
  </head>

  <body>
    <header>
      <div class="bar">
        <div class="brand">
          <img src="/blueprint_store_static/images/bps_logo.png" alt="Blueprint Store"/>
          <span>Blueprint Store</span>
        </div>

        <sl-input id="search" placeholder="Search titles & descriptions..." clearable pill>
          <sl-icon name="search" slot="prefix"></sl-icon>
        </sl-input>

        <sl-select id="sort" value="likes" hoist>
          <sl-option value="likes">Most liked</sl-option>
          <sl-option value="new">Newest</sl-option>
          <sl-option value="title">Title A–Z</sl-option>
        </sl-select>

        <sl-dropdown id="tagdd" hoist>
          <sl-button id="tagbtn" slot="trigger" caret class="plain" pill>All tags</sl-button>
          <sl-menu id="tagmenu"></sl-menu>
        </sl-dropdown>

        <sl-button id="refresh" class="plain" pill>Refresh</sl-button>
      </div>
    </header>

    <main>
      <div class="banner"><img src="/blueprint_store_static/images/bps_banner.png" alt="Blueprint Store banner"></div>

      <!-- Creators Spotlight -->
      <section id="creators" class="contrib" style="display:none">
        <div class="contrib-head">
          <h3>Creators Spotlight</h3>
          <span class="contrib-sub">Shout-outs to makers moving the community forward.</span>
          <span id="creators-loading" class="loader" aria-label="Loading" title="Loading"></span>
        </div>
        <div class="contrib-grid">
          <div class="contrib-card">
            <h4>Most Popular Blueprint</h4>
            <div class="contrib-author" id="c_pop_author">—</div>
            <div id="c_pop_title">—</div>
          </div>
          <div class="contrib-card">
            <h4>Most Uploaded Blueprints</h4>
            <div class="contrib-author" id="c_up_author">—</div>
            <div id="c_up_count">—</div>
          </div>
          <div class="contrib-card">
            <h4>Most Recent Upload</h4>
            <div class="contrib-author" id="c_recent_author">—</div>
            <div id="c_recent_title">—</div>
          </div>
        </div>
      </section>

      <div id="headingEl" class="section-title">All blueprints</div>
      <div id="list" class="cards-wrap"></div>

      <p id="empty" style="display:none">No blueprints matched.</p>
      <p id="error" style="display:none"></p>
      <div id="sentinel"></div>
    </main>

    <!-- cache-busted -->
    <script src="./app.js?v=2025-10-spotlight-desc-single" defer></script>
  </body>
</html>
